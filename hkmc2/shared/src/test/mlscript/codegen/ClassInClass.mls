:js

:import PredefJS.mls
//│ Imported 2 member(s)


:sjs
class Outer(a, b) with
  class Inner(c) with
    fun i1(d) = [b, c, d]
    log(a)
    log(c)
    log(i1(a))
  fun o1(c) = Inner(c)
  fun o2(c, d) = Inner(c).i1(d)
  val i = Inner(a)
  log(i.c)
  log(i.i1(1))
//│ JS (unsanitized):
//│ this.Outer = function Outer(a1, b1) { return new Outer.class(a1, b1); };
//│ this.Outer.class = class Outer {
//│   constructor(a, b) {
//│     this.a = a;
//│     this.b = b;
//│     let tmp, tmp1, tmp2;
//│     
//│     const this$Outer = this;
//│     this.Inner = function Inner(c1) { return new Inner.class(c1); };
//│     this.Inner.class = class Inner {
//│       constructor(c) {
//│         this.c = c;
//│         let tmp3, tmp4, tmp5;
//│         tmp3 = globalThis.log(this$Outer.a);
//│         tmp4 = globalThis.log(this.c);
//│         tmp5 = this.i1(this$Outer.a);
//│         globalThis.log(tmp5)
//│       }
//│       i1(d) {
//│         return [
//│           this$Outer.b,
//│           this.c,
//│           d
//│         ];
//│       }
//│       toString() { return "Inner(" + this.c + ")"; }
//│     };
//│     tmp = this.Inner(this.a);
//│     this.i = tmp;
//│     tmp1 = globalThis.log(this.i.c);
//│     tmp2 = this.i.i1(1) ?? null;
//│     globalThis.log(tmp2)
//│   }
//│   o1(c) {
//│     return this.Inner(c);
//│   } 
//│   o2(c1, d) {
//│     let tmp;
//│     tmp = this.Inner(c1);
//│     return tmp.i1(d) ?? null;
//│   }
//│   toString() { return "Outer(" + this.a + ", " + this.b + ")"; }
//│ };
//│ null


val o = Outer(100, 200)
//│ > 100
//│ > 100
//│ > [ 200, 100, 100 ]
//│ > 100
//│ > [ 200, 100, 1 ]
//│ > Outer {
//│ >   a: 100,
//│ >   b: 200,
//│ >   Inner: [Function: Inner] { class: [class Inner] },
//│ >   i: Inner { c: 100 }
//│ o = }

o.o1(30)
//│ > 100
//│ > 30
//│ > [ 200, 30, 100 ]
//│ = Inner { c: 30 }

o.o2(30, 40)
//│ > 100
//│ > 30
//│ > [ 200, 30, 100 ]
//│ = [ 200, 30, 40 ]

o.i
//│ = Inner { c: 100 }


