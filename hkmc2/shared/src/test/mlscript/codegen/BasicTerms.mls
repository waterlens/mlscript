:js

:global
:sjs


1
//│ JS (unsanitized):
//│ 1
//│ = 1

:lot
:w
1
2
//│ ╔══[WARNING] Pure expression in statement position
//│ ║  l.14: 	1
//│ ╙──      	^
//│ JS (unsanitized):
//│ 2
//│ ╔══[WARNING] Pure expression in statement position
//│ ║  l.14: 	1
//│ ╙──      	^
//│ Lowered:
//│ Program:
//│   imports = Nil
//│   main = Assign:
//│     lhs = $block$res
//│     rhs = Lit of IntLit of 2
//│     rest = Return: \
//│     res = Lit of UnitLit of false
//│     implct = true
//│ = 2


:fixme // should be a "linking" error
log("Hi")
//│ JS (unsanitized):
//│ this.log("Hi") ?? null
//│ ═══[RUNTIME ERROR] Error: Access to required field 'log' yielded 'undefined'

:fixme
:lot
log("Hi")
2
//│ JS (unsanitized):
//│ let tmp1; tmp1 = this.log("Hi") ?? null; 2
//│ Lowered:
//│ Program:
//│   imports = Nil
//│   main = Assign:
//│     lhs = $selRes
//│     rhs = Select{member:log}:
//│       qual = Ref of globalThis:globalThis
//│       name = Ident of "log"
//│     rest = Begin: \
//│     sub = Match:
//│       scrut = Ref of $selRes
//│       arms = Ls of 
//│         Tuple2:
//│           _1 = Lit of UnitLit of false
//│           _2 = Throw of Instantiate:
//│             cls = Select:
//│               qual = Ref of globalThis:globalThis
//│               name = Ident of "Error"
//│             args = Ls of 
//│               Lit of StrLit of "Access to required field 'log' yielded 'undefined'"
//│       dflt = S of Assign:
//│         lhs = $tmp
//│         rhs = Ref of $selRes
//│         rest = End of ""
//│       rest = End of ""
//│     rest = Assign: \
//│     lhs = $tmp
//│     rhs = Call:
//│       fun = Ref of $tmp
//│       args = Ls of 
//│         Arg:
//│           spread = false
//│           value = Lit of StrLit of "Hi"
//│     rest = Assign: \
//│     lhs = $block$res
//│     rhs = Lit of IntLit of 2
//│     rest = Return: \
//│     res = Lit of UnitLit of false
//│     implct = true
//│ ═══[RUNTIME ERROR] Error: Access to required field 'log' yielded 'undefined'


:re
2(2)
//│ JS (unsanitized):
//│ 2(2) ?? null
//│ ═══[RUNTIME ERROR] TypeError: 2 is not a function


